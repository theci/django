데이터베이스에 employee 테이블이 있구요
이 테이블은 장고 서비스에서는 접근이 허용되지 않은 테이블이라고 가정해봅시다 장고 웹
서비스에는 junior Employee View를 만들어서 주니어 직원에 한해서 일부
컬럼만 노출토록 합니다
InspectDB 명령은 데이터베이스 테이블뿐만 아니라 데이터베이스 뷰에 대해서도
동작하므로 InspectDB 명령을 사용해서 junior Employee View에 대한 장고
모델 초안을 생성합니다
이때 생성된 모델의 이름에서 View를 제외하여 간결하게 만들고요 이 모델에서
employee-id 컬럼은 기본 키로 사용하겠고요
필드명은 다른 모델과의 일관성을 위해서 id로 바꾸겠습니다 모델 필드명과 맵핑되는
데이터베이스 컬럼명은 db_column 속성을 통해 지정하실 수 있습니다
모델 필드명과 데이터베이스 컬럼명이 같을 경우에는 db_column 속성을 지정하지
않으셔도 됩니다
모델 필드명에서는 데이터베이스 컬럼명에 자주 사용되는 테이블명 접두사를 제거하는 것이
좋습니다 데이터베이스 쿼리에서는 컬럼명 앞에 테이블명을 생략하는 경우가 많기에 테이블명을
컬럼명의 접두사로 사용하기도 합니다
하지만 장고 모델에서는 필드가 항상 모델 인스턴스를 통해 참조하므로 불필요하게 반복되는
테이블명 접두사는 코드의 가독성을 해치기 때문에 제거하기를 추천합니다
junior-employee.firstname 코드와 junior-employee.employee.firstname 코드
중에 어떤 코드를 선택하시겠어요?
장고 셀을 통해 주니어 인플로이 모델의 쿼디셋을 수행해 보면 주니어 인플로이 뷰를 통해
쿼리가 동작함을 확인하실 수 있습니다. 슬라이드 하단의 안내된 링크를 통해 이 페이지를
확인하실 수 있고요 데이터베이스 패널에서 현재 장고 프로젝트에서 사용하는
PostgreSQL 데이터베이스에 대한 쿼리 콘솔 창을 하나 엽니다
Create Table Inflowy 쿼리를 복사해서 쿼리 콘솔 창에서 실행해서 테이블을
생성해 주시고 이어서 CreateView 쿼리도 복사해서 쿼디 콘솔 창에서 실행해서 뷰를
생성해 주세요
데이터베이스 패널을 새로 고침하시면 생성된 테이블과 뷰를 확인하실 수 있습니다
inspectdb 명령 인자로 데이터베이스 뷰 이름을 지정하여 모델 코드를 자동 생성합니다
생성된 모델 코드를 복사해서 샵의 모델 스파이 파일에 붙여넣겠습니다
모델명에서 뷰도 제거하고요
employee_id field는 employee 테이블에서 기본키로 사용되는 것을 알기에
모델에서도 기본키로 설정하겠습니다
필드명은 id로 변경하고 db 컬럼 속성으로 employee_id 컬럼명을 지정합니다.
각 필드는 인플로이 테이블에서 낫널 필드임을 알기에 블랭크 속성과 널 속성도 모두
제거하겠습니다 모델 필드명에서 인플로이_ 접두사를 제거하고 DB 컬럼 속성으로
컬럼명을 지정합니다
인플로이 샘플 데이터를 준비했습니다
샘플 코드 페이지 하단에서 인서트 SQL 코드를 확인하실 수 있고요 이 코드를 복사해서
쿼리 콘솔을 통해 실행해 주세요
인플로이 테이블에 10건의 데이터를 추가했습니다.
인플로이 테이블 이름을 더블 클릭하시면 10건의 데이터를 확인하실 수 있고요.
이 중 주니어 데이터는 3건입니다.
주니어 인플로이 뷰 이름을 더블 클릭하시면 3건의 데이터를 확인하실 수 있습니다.
장고 셀을 구동하시고 주니어 인플로이 모델을 통해 조회하시면 이렇게 주니어 인플로이 뷰를
통해 3건이 조회됨을 확인하실 수 있습니다.